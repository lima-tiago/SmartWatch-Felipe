!function(a){a.gfV1Countdown=function(b,c){var d={time:"2010/12/31 00:00:00",type:"default",precision:1e3,elapse:!1,id:null,idSlug:null,onTimeChange:function(a){},stoped:function(a){},finish:function(a){}};this.settings={};var e,f,g,h,i=this,j=a(b),k={Y:"years",m:"months",n:"daysToMonth",d:"daysToWeek",w:"weeks",W:"weeksToMonth",H:"hours",M:"minutes",S:"seconds",D:"totalDays",I:"totalHours",N:"totalMinutes",T:"totalSeconds"},l=null,m=null,n=null;this.init=function(){return this.settings=a.extend({},d,c),i.setTemplate(),i.setFinalDate(i.settings.time),i.start(),!1},this.setTemplate=function(){if(i.settings.idSlug){g=a(".gryffeditor").hasClass("editing")?"dev":"production";var b=j.data("week"),c=j.data("day"),d=j.data("hour"),e=j.data("minute"),h=j.data("second"),k=j.data("type");if(0==j.find(".count-down-inner").length){var l=j.data("weeklabel"),m=j.data("daylabel"),n=j.data("hourlabel"),o=j.data("minutelabel"),p=j.data("secondlabel"),q='<div class="count-down-wrap"><div class="count-down-inner">';"1"==b&&(q+='<div class="week-left time-left"><span class="num">00</span><span class="count-label">'+l+"</span></div>"),"1"==c&&(q+='<div class="day-left time-left"><span class="num">00</span><span class="count-label">'+m+"</span></div>"),"1"==d&&(q+='<div class="hour-left time-left"><span class="num">00</span><span class="count-label">'+n+"</span></div>"),"1"==e&&(q+='<div class="minute-left time-left"><span class="num">00</span><span class="count-label">'+o+"</span></div>"),"1"==h&&(q+='<div class="second-left time-left"><span class="num">00</span><span class="count-label">'+p+"</span></div>"),q+="</div></div>",j.html(q)}f=j.find(".count-down-inner");var r=j.data("end");if("2010/12/31 00:00:00"==r){var s=new Date;s.setDate(s.getDate()+8),s.setSeconds(s.getSeconds()+12);var t=[s.getFullYear(),s.getMonth()+1,s.getDate()].join("/")+" "+[s.getHours(),s.getMinutes(),s.getSeconds()].join(":");r=t}if("daily"==k?r=j.data("daily"):"evergreen"==k&&(r=j.data("evergreen")),i.settings.type=k,i.settings.time=r,"dev"==g){var u=i.settings.id,v=u.toString().replace(/-/g,"");if(v==i.settings.idSlug){var w="getCountdown"+i.settings.idSlug;window[w]=function(){return j.data("gfv1countdown")}}}}},this.start=function(){null!==l&&clearInterval(l);var a=this;i.update(),l=setInterval(function(){a.update.call(a)},i.settings.precision)},this.stop=function(){clearInterval(l),l=null,i.dispatchEvent("stoped")},this.toggle=function(){l?i.stop():i.start()},this.setCookie=function(a,b,c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="expires="+d.toUTCString();document.cookie=a+"="+b+";"+e+";path=/"},this.getCookie=function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return""},this.deleteCookie=function(a){document.cookie=a+"=; expires=Thu, Jan 01 1970 00:00:00 UTC;path=/"},this.refeshCookie=function(a,b){e="gp-evergreen-"+i.settings.id+a,i.deleteCookie(e),h=b},this.setFinalDate=function(a){function b(){var a=0,b=["1"];i.settings.time&&""!=i.settings.time&&(i.settings.time=i.settings.time.toString(),b=i.settings.time.indexOf(",")!==-1?i.settings.time.split(","):[i.settings.time]);for(var c=0;c<b.length;c++){var d=b[c];d=d.toLowerCase(d).trim(),d.indexOf("d")!=-1?isNaN(parseInt(d))||(a+=86400*parseInt(d)):d.indexOf("h")!=-1?isNaN(parseInt(d))||(a+=3600*parseInt(d)):d.indexOf("m")!=-1?isNaN(parseInt(d))||(a+=60*parseInt(d)):d.indexOf("s")!=-1&&(isNaN(parseInt(d))||(a+=parseInt(d)))}return 1e3*a}if("daily"==i.settings.type){var c=new Date,d={day:c.getDate(),month:c.getMonth()+1,year:c.getFullYear(),hour:c.getHours(),minute:c.getMinutes(),second:c.getSeconds()};c.getTime();if(i.settings.time&&""!=i.settings.time){var f=["1"];i.settings.time=i.settings.time.toString();var g=i.settings.time;g=g.toLowerCase(),f=i.settings.time.indexOf(",")!==-1?g.split(","):[g];for(var k=0;k<f.length;k++){var l=f[k].trim();l.indexOf("h")!==-1&&(isNaN(parseInt(l))||(d.hour=parseInt(l))),l.indexOf("m")!==-1&&(isNaN(parseInt(l))||(d.minute=parseInt(l))),l.indexOf("s")!==-1&&(isNaN(parseInt(l))||(d.second=parseInt(l)))}var n=[d.year,d.month,d.day].join("/")+" "+[d.hour,d.minute,d.second].join(":"),o=new Date(n);o.setDate(o.getDate()+1),d.hour<c.getHours()?(d.year=o.getFullYear(),d.month=o.getMonth()+1,d.day=o.getDate()):d.hour==c.getHours()&&d.minute<c.getMinutes()?(d.year=o.getFullYear(),d.month=o.getMonth()+1,d.day=o.getDate()):d.hour==c.getHours()&&d.minute==c.getMinutes()&&d.second<c.getSeconds()&&(d.year=o.getFullYear(),d.month=o.getMonth()+1,d.day=o.getDate())}var n=[d.year,d.month,d.day].join("/")+" "+[d.hour,d.minute,d.second].join(":");m=i.parseDateString(n)}else if("evergreen"==i.settings.type){h="",i.settings.idSlug&&(h="undefined"!=typeof j.data("cookietime")?j.data("cookietime"):"");var p=b();e="gp-evergreen-"+i.settings.id+h;var q=i.getCookie(e);if(q&&void 0!=q&&parseInt(q)+p<=Date.now()){var r=new Date;m=i.parseDateString(r)}else{var s=q;s&&""!=s||(s=Date.now(),i.setCookie(e,s,30));var g=parseInt(s)+p,r=new Date(g),n=[r.getFullYear(),r.getMonth()+1,r.getDate()].join("/")+" "+[r.getHours(),r.getMinutes(),r.getSeconds()].join(":");m=i.parseDateString(n)}}else m=i.parseDateString(a)},this.update=function(){var a,b=new Date;a=m.getTime()-b.getTime(),a=Math.ceil(a/1e3),a=!i.settings.elapse&&a<0?0:Math.abs(a);var c;if(c!==a)if(c=a,i.settings.elapsed=b>=m,n={seconds:c%60,minutes:Math.floor(c/60)%60,hours:Math.floor(c/60/60)%24,days:Math.floor(c/60/60/24)%7,daysToWeek:Math.floor(c/60/60/24)%7,daysToMonth:Math.floor(c/60/60/24%30.4368),weeks:Math.floor(c/60/60/24/7),weeksToMonth:Math.floor(c/60/60/24/7)%4,months:Math.floor(c/60/60/24/30.4368),years:Math.abs(m.getFullYear()-b.getFullYear()),totalDays:Math.floor(c/60/60/24),totalHours:Math.floor(c/60/60),totalMinutes:Math.floor(c/60),totalSeconds:c},0===c){if("daily"==i.settings.type&&(i.setFinalDate(i.settings.time),i.dispatchEvent("update"),i.dispatchEvent("redirect")),"evergreen"==i.settings.type){var d="undefined"!=typeof j.data("evergreenloop")?j.data("evergreenloop"):"0";"1"==d||1==d?(e="gp-evergreen-"+i.settings.id+h,i.deleteCookie(e),i.setFinalDate(i.settings.time),i.dispatchEvent("update")):(i.stop(),i.dispatchEvent("finish"),i.dispatchEvent("redirect"))}"standard"==i.settings.type&&(i.stop(),i.dispatchEvent("finish"),i.dispatchEvent("redirect"))}else i.dispatchEvent("update")},this.dispatchEvent=function(b){var c={finalDate:"",elapsed:"",offset:"",strftime:""};if(c.finalDate=m,c.elapsed=i.settings.elapsed,c.offset=a.extend({},n),c.strftime=i.strftime(n),i.settings.idSlug){var d=j.data("week"),e=j.data("day"),h=j.data("hour"),k=j.data("minute");j.data("second");f.children(".week-left").children(".num").text(c.strftime("%w")),"1"==d?f.children(".day-left").children(".num").text(c.strftime("%d")):f.children(".day-left").children(".num").text(c.strftime("%D")),"0"==d&&"0"==e?f.children(".hour-left").children(".num").text(c.strftime("%I")):f.children(".hour-left").children(".num").text(c.strftime("%H")),"0"==d&&"0"==e&&"0"==h?f.children(".minute-left").children(".num").text(c.strftime("%N")):f.children(".minute-left").children(".num").text(c.strftime("%M")),"0"==d&&"0"==e&&"0"==h&&"0"==k?f.children(".second-left").children(".num").text(c.strftime("%T")):f.children(".second-left").children(".num").text(c.strftime("%S"))}if(g&&"production"==g&&"redirect"==b&&i.settings.idSlug){var l=j.data("redirect");l&&"#"!=l&&""!=l&&(window.location.href=l)}i.settings.onTimeChange(c)},this.parseDateString=function(a){if(a instanceof Date)return a;var b=[];if(b.push(/^[0-9]*$/.source),b.push(/([0-9]{1,2}\/){2}[0-9]{4}( [0-9]{1,2}(:[0-9]{2}){2})?/.source),b.push(/[0-9]{4}([\/\-][0-9]{1,2}){2}( [0-9]{1,2}(:[0-9]{2}){2})?/.source),b=new RegExp(b.join("|")),String(a).match(b))return String(a).match(/^[0-9]*$/)&&(a=Number(a)),String(a).match(/\-/)&&(a=String(a).replace(/\-/g,"/")),new Date(a);throw new Error("Couldn't cast `"+a+"` to a date object.")},this.escapedRegExp=function(a){var b=a.toString().replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");return new RegExp(b)},this.strftime=function(a){return function(b){var c=b.match(/%(-|!)?[A-Z]{1}(:[^;]+;)?/gi);if(c)for(var d=0,e=c.length;d<e;++d){var f=c[d].match(/%(-|!)?([a-zA-Z]{1})(:[^;]+;)?/),g=i.escapedRegExp(f[0]),h=f[1]||"",j=f[3]||"",l=null;f=f[2],k.hasOwnProperty(f)&&(l=k[f],l=Number(a[l])),null!==l&&("!"===h&&(l=i.pluralize(j,l)),""===h&&l<10&&(l="0"+l.toString()),b=b.replace(g,l.toString()))}return b=b.replace(/%%/,"%")}},this.pluralize=function(a,b){var c="s",d="";return a&&(a=a.replace(/(:|;|\s)/gi,"").split(/\,/),1===a.length?c=a[0]:(d=a[0],c=a[1])),Math.abs(b)>1?c:d},this.init()},a.fn.gfV1Countdown=function(b){return this.each(function(){if(void 0==a(this).data("gfv1countdown")){var c=new a.gfV1Countdown(this,b);a(this).data("gfv1countdown",c)}})}}(jQuery);